/* Enhanced mobile protection for MediaPlayer component */
.video-player {
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  -webkit-user-drag: none;
  -moz-user-drag: none;
  /* Enhanced mobile drag prevention */
  pointer-events: auto;
  -webkit-touch-callout: none;
}

/* Enhanced mobile-specific video player adjustments */
@media (max-width: 768px) {
  .video-player {
    min-height: 200px !important;
    border-radius: 8px;
    /* Prevent zoom on double tap */
    touch-action: manipulation;
    /* Better mobile video rendering */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }

  .audio-player {
    height: 48px !important;
    /* Prevent accidental interaction */
    touch-action: manipulation;
  }

  /* Better mobile container behavior */
  .media-player-container {
    /* Prevent scroll bounce */
    overscroll-behavior: contain;
    /* Smoother interactions */
    will-change: transform;
  }
}

/* Prevent mobile browser download prompts */
video {
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  touch-action: manipulation !important;
}

/* Hide mobile browser menu options */
@media (max-width: 768px) {
  .media-player-container {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  /* Enhanced mobile fullscreen button */
  .fullscreen-button {
    min-width: 48px !important;
    min-height: 48px !important;
    padding: 12px !important;
    /* Better touch target for mobile */
    -webkit-tap-highlight-color: rgba(255, 255, 255, 0.2);
  }

  /* Adjust mobile overlay to ensure fullscreen button area is clear */
  .media-player-container .absolute.inset-0 {
    clip-path: polygon(
      0% 0%,
      80% 0%,
      80% 20%,
      100% 20%,
      100% 100%,
      0% 100%
    ) !important;
  }
}

/* Hide download option in video controls */
video::-webkit-media-controls-download-button {
  display: none;
}

video::-webkit-media-controls-enclosure {
  overflow: hidden;
}

/* Ensure fullscreen button remains fully functional */
.fullscreen-button {
  pointer-events: auto !important;
  -webkit-touch-callout: auto !important;
  -webkit-user-select: auto !important;
  -moz-user-select: auto !important;
  -ms-user-select: auto !important;
  user-select: auto !important;
  touch-action: auto !important;
  position: relative;
  z-index: 999 !important;
  /* Better mobile touch experience */
  -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
  transition: all 0.2s ease;
}

.fullscreen-button:hover {
  cursor: pointer !important;
  transform: scale(1.05);
}

.fullscreen-button:active {
  transform: scale(0.95);
  background-color: rgba(0, 0, 0, 0.8) !important;
}

/* Ensure fullscreen button area is not affected by overlays */
.fullscreen-button * {
  pointer-events: auto !important;
}

/* Enhanced mobile video controls with aggressive visibility enforcement - FULLSCREEN ONLY */
@media (max-width: 768px) {
  /* Force video element to always show controls ONLY in fullscreen mode */
  .video-player:fullscreen,
  .video-player:-webkit-full-screen,
  .video-player:-moz-full-screen {
    /* Browser-specific control auto-hide prevention - FULLSCREEN ONLY */
    -webkit-media-controls-auto-hide-time: never !important;
    -webkit-media-controls-auto-hide-delay: 999999s !important;
    -moz-media-controls-auto-hide-time: never !important;
    -ms-media-controls-auto-hide-time: never !important;
  }

  /* Ensure normal auto-hide behavior for non-fullscreen mobile video */
  .video-player:not(:fullscreen):not(:-webkit-full-screen):not(
      :-moz-full-screen
    ) {
    -webkit-media-controls-auto-hide-time: 3s !important;
    -webkit-media-controls-auto-hide-delay: 3s !important;
  }

  /* Webkit-specific controls visibility - FULLSCREEN ONLY */
  .video-player:fullscreen::-webkit-media-controls-panel {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) !important;
    transition: none !important;
    animation: none !important;
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 2147483647 !important;
  }

  .video-player:-webkit-full-screen::-webkit-media-controls-panel {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) !important;
    transition: none !important;
    animation: none !important;
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 2147483647 !important;
  }

  /* Restore normal behavior for non-fullscreen mobile video */
  .video-player:not(:fullscreen):not(
      :-webkit-full-screen
    )::-webkit-media-controls-panel {
    position: relative !important;
    z-index: auto !important;
  }

  /* Force all control elements to be visible - FULLSCREEN ONLY */
  .video-player:fullscreen::-webkit-media-controls {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    animation: none !important;
    transition: none !important;
    pointer-events: auto !important;
  }

  .video-player:-webkit-full-screen::-webkit-media-controls {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    animation: none !important;
    transition: none !important;
    pointer-events: auto !important;
  }

  /* Force controls enclosure to be visible - FULLSCREEN ONLY */
  .video-player:fullscreen::-webkit-media-controls-enclosure {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    position: relative !important;
    bottom: 0 !important;
    transform: none !important;
    animation: none !important;
    transition: none !important;
  }

  .video-player:-webkit-full-screen::-webkit-media-controls-enclosure {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    position: relative !important;
    bottom: 0 !important;
    transform: none !important;
    animation: none !important;
    transition: none !important;
  }

  /* Ensure individual control buttons are visible - FULLSCREEN ONLY */
  .video-player:fullscreen::-webkit-media-controls-play-button,
  .video-player:fullscreen::-webkit-media-controls-fullscreen-button,
  .video-player:fullscreen::-webkit-media-controls-timeline,
  .video-player:fullscreen::-webkit-media-controls-current-time-display,
  .video-player:fullscreen::-webkit-media-controls-time-remaining-display,
  .video-player:fullscreen::-webkit-media-controls-mute-button,
  .video-player:fullscreen::-webkit-media-controls-volume-slider {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
  }

  .video-player:-webkit-full-screen::-webkit-media-controls-play-button,
  .video-player:-webkit-full-screen::-webkit-media-controls-fullscreen-button,
  .video-player:-webkit-full-screen::-webkit-media-controls-timeline,
  .video-player:-webkit-full-screen::-webkit-media-controls-current-time-display,
  .video-player:-webkit-full-screen::-webkit-media-controls-time-remaining-display,
  .video-player:-webkit-full-screen::-webkit-media-controls-mute-button,
  .video-player:-webkit-full-screen::-webkit-media-controls-volume-slider {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
  }

  /* Make native controls more prominent in mobile fullscreen */
  .video-player:fullscreen::-webkit-media-controls-panel,
  .video-player:-webkit-full-screen::-webkit-media-controls-panel {
    /* Larger touch target for small screens */
    border-radius: 8px;
  }

  /* Adjust overlay clip-path for smaller screens */
  .media-player-container .absolute.inset-0 {
    clip-path: polygon(
      0% 0%,
      75% 0%,
      75% 25%,
      100% 25%,
      100% 100%,
      0% 100%
    ) !important;
  }
}

/* Landscape mode optimizations for mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .video-player {
    min-height: 150px !important;
    max-height: 90vh;
    /* Prevent video from being too tall in landscape */
  }
}

/* High DPI screen optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .fullscreen-button {
    /* Crisp icons on retina displays */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  .video-player {
    /* Better video rendering on high DPI */
    image-rendering: -webkit-optimize-contrast;
  }
}

/* Dark mode considerations for mobile */
@media (prefers-color-scheme: dark) {
  .fullscreen-button {
    background-color: rgba(0, 0, 0, 0.7) !important;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .fullscreen-button:hover {
    background-color: rgba(0, 0, 0, 0.9) !important;
  }
}

/* Enhanced fullscreen mode styling for better visibility */
.video-player:fullscreen ~ .fullscreen-button,
.video-player:-webkit-full-screen ~ .fullscreen-button,
.video-player:-moz-full-screen ~ .fullscreen-button {
  /* Make button more visible in fullscreen mode */
  background-color: rgba(0, 0, 0, 0.8) !important;
  opacity: 0.9 !important;
  border: 2px solid rgba(255, 255, 255, 0.3) !important;
  backdrop-filter: blur(10px) !important;
}

/* Mobile fullscreen exit enhancements */
@media (max-width: 768px) {
  .video-player:fullscreen ~ .fullscreen-button,
  .video-player:-webkit-full-screen ~ .fullscreen-button,
  .video-player:-moz-full-screen ~ .fullscreen-button {
    /* Larger, more visible exit button on mobile */
    min-width: 56px !important;
    min-height: 56px !important;
    padding: 16px !important;
    top: 20px !important;
    right: 20px !important;
    background-color: rgba(0, 0, 0, 0.9) !important;
    border: 3px solid rgba(255, 255, 255, 0.5) !important;
    border-radius: 12px !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5) !important;
  }
}

/* Light mode considerations for mobile */
@media (prefers-color-scheme: light) {
  .fullscreen-button {
    background-color: rgba(255, 255, 255, 0.8) !important;
    color: #000 !important;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .fullscreen-button:hover {
    background-color: rgba(255, 255, 255, 0.95) !important;
  }
}

/* Accessibility improvements for mobile */
@media (max-width: 768px) {
  .fullscreen-button:focus {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
    /* Better focus visibility on mobile */
  }

  /* Improve tap targets for better accessibility */
  .fullscreen-button {
    /* Ensure minimum 44px touch target as per WCAG guidelines */
    min-width: 44px !important;
    min-height: 44px !important;
  }
}

/* Prevent mobile browser zoom on form elements */
.media-player-container input,
.media-player-container button,
.media-player-container select {
  font-size: 16px !important;
  /* Prevents zoom on iOS Safari */
}

/* Enhanced video loading states for mobile */
.video-player::-webkit-media-controls-play-button,
.video-player::-webkit-media-controls-start-playback-button {
  /* Larger play button for mobile */
  transform: scale(1.2);
}

/* Mobile-specific video fullscreen handling */
.video-player:fullscreen {
  object-fit: contain;
  background: #000;
  /* Better fullscreen experience */
}

.video-player:-webkit-full-screen {
  object-fit: contain;
  background: #000;
}

.video-player:-moz-full-screen {
  object-fit: contain;
  background: #000;
}

/* Force video controls to always be visible in fullscreen on mobile */
@media (max-width: 768px) {
  /* Primary controls visibility */
  .video-player:fullscreen::-webkit-media-controls-panel {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) !important;
    transition: none !important;
  }

  .video-player:-webkit-full-screen::-webkit-media-controls-panel {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) !important;
    transition: none !important;
  }

  /* Force all control elements to be visible */
  .video-player:fullscreen::-webkit-media-controls {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    animation: none !important;
    transition: none !important;
  }

  .video-player:-webkit-full-screen::-webkit-media-controls {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    animation: none !important;
    transition: none !important;
  }

  /* Ensure fullscreen button in native controls is visible */
  .video-player:fullscreen::-webkit-media-controls-fullscreen-button,
  .video-player:-webkit-full-screen::-webkit-media-controls-fullscreen-button {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Force controls to stay visible and prevent auto-hide - Multiple approaches */
  .video-player:fullscreen {
    -webkit-media-controls-auto-hide-time: never !important;
    -webkit-media-controls-auto-hide-delay: 999999s !important;
  }

  .video-player:-webkit-full-screen {
    -webkit-media-controls-auto-hide-time: never !important;
    -webkit-media-controls-auto-hide-delay: 999999s !important;
  }

  /* Force controls container visibility */
  .video-player:fullscreen::-webkit-media-controls-enclosure {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    position: relative !important;
    bottom: 0 !important;
  }

  .video-player:-webkit-full-screen::-webkit-media-controls-enclosure {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    position: relative !important;
    bottom: 0 !important;
  }

  /* Make native controls more prominent in mobile fullscreen */
  .video-player:fullscreen::-webkit-media-controls-panel,
  .video-player:-webkit-full-screen::-webkit-media-controls-panel {
    background: rgba(0, 0, 0, 0.8) !important;
    backdrop-filter: blur(10px) !important;
  }

  /* Ensure control buttons are large enough for touch */
  .video-player:fullscreen::-webkit-media-controls-play-button,
  .video-player:fullscreen::-webkit-media-controls-fullscreen-button,
  .video-player:-webkit-full-screen::-webkit-media-controls-play-button,
  .video-player:-webkit-full-screen::-webkit-media-controls-fullscreen-button {
    min-width: 44px !important;
    min-height: 44px !important;
  }
}

/* Ultra-robust fullscreen mobile control visibility strategies */
video.force-controls-visible::-webkit-media-controls-panel,
video.fullscreen-mobile-controls-visible::-webkit-media-controls-panel {
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  display: flex !important;
  transform: translateY(0) !important;
}

video.force-controls-visible::-webkit-media-controls,
video.fullscreen-mobile-controls-visible::-webkit-media-controls {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
}

video.force-controls-visible::-webkit-media-controls-fullscreen-button,
video.fullscreen-mobile-controls-visible::-webkit-media-controls-fullscreen-button {
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  display: block !important;
}

/* Force controls to always show when video has these classes */
video.force-controls-visible,
video.fullscreen-mobile-controls-visible {
  -webkit-media-controls-auto-hide-time: 15s !important;
  -webkit-media-controls-auto-hide-delay: 0s !important;
}

/* Emergency last-resort control visibility */
video[data-controls-forced='true']::-webkit-media-controls-panel {
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  display: flex !important;
  bottom: 0 !important;
  position: absolute !important;
  z-index: 2147483647 !important;
}

video[data-controls-forced='true']::-webkit-media-controls-fullscreen-button {
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  display: block !important;
  position: relative !important;
  z-index: 2147483647 !important;
}

/* Enhanced mobile fullscreen control visibility */
@media (max-width: 768px) {
  video:fullscreen.force-controls-visible,
  video:fullscreen.fullscreen-mobile-controls-visible,
  video:fullscreen[data-controls-forced='true'] {
    -webkit-media-controls-auto-hide-time: 20s !important;
    -webkit-media-controls-auto-hide-delay: 0s !important;
  }

  video:fullscreen.force-controls-visible::-webkit-media-controls-panel,
  video:fullscreen.fullscreen-mobile-controls-visible::-webkit-media-controls-panel,
  video:fullscreen[data-controls-forced='true']::-webkit-media-controls-panel {
    opacity: 1 !important;
    visibility: visible !important;
    display: flex !important;
    pointer-events: auto !important;
    transform: translateY(0) !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    position: fixed !important;
    z-index: 2147483647 !important;
    background: rgba(0, 0, 0, 0.8) !important;
  }
}

/* Mobile fullscreen exit hint animation */
@keyframes fadeInOut {
  0% {
    opacity: 0;
    transform: translateX(-50%) translateY(-10px);
  }
  20% {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
  80% {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
  100% {
    opacity: 0;
    transform: translateX(-50%) translateY(-10px);
  }
}

.mobile-fullscreen-hint {
  animation: fadeInOut 4s ease-in-out forwards;
}

/* Enhanced mobile exit instructions */
@media (max-width: 768px) {
  .mobile-fullscreen-hint {
    font-size: 14px !important;
    padding: 8px 12px !important;
  }
}
